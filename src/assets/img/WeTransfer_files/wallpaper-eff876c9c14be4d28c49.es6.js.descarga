(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{900:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r(21);const n={adzerk:{api:"https://e-10220.adzerk.net/api/v2",adTypes:{video:3502,wallpaper:959},siteId:1055922,networkId:10220,placements:{iframe:"iframe",video:"video"}},walter:{api:r.n(a)()(window,"__walter_api__.url","")},host:"https://backgrounds.wetransfer.net/",editorialUrl:"https://editorial-wallpaper.wetransfer.com/ed",legacyEditorialUrl:"https://wtplus.wetransfer.com/",defaultRotationInterval:45e3,plusRotationInterval:3e4,rotationIntervals:[[26,6e5],[11,18e4],[1,45e3]],rotationSlots:{199071:[1,1],199072:[2,2],199073:[3,3],199074:[4,4],199075:[5,5],199076:[6,6],199077:[7,7],199078:[8,8],199079:[9,9],199080:[10,10],199081:[11,11],199082:[12,12],199083:[13,13],199084:[14,14],199085:[15,15],199086:[16,16],205287:[17,17],205288:[18,18],205289:[19,19],205290:[20,20],205291:[21,21],205292:[22,22],205293:[23,23],205294:[24,24],205295:[25,25],205296:[26,30],205297:[31,40],205298:[41,50],205270:[51,60],205271:[61,70],205272:[71,80],205273:[81,90],205274:[91,100],205275:[101,150],205276:[151,200],205277:[201,250],205278:[251,1/0]},fallback:{src:"brand/1905/fallback_v3/index.html",rotationInterval:1e4},transition:{duration:1e3,easing:"ease"},format:{get IMAGE(){return"image"},get HTML5(){return"html5"},get VIDEO(){return"video"}},dev:{enabled:!1,creatives:[]}}},948:function(e,t,r){},961:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Ve}));var a=r(109),n=r(2),s=r.n(n),o=r(893),i=r.n(o),l=r(11),c=r(88),p=r(900),d=r(121),u=r.n(d);const m={isPaused:!1,timer:null,start(e,t){this.timer=new u.a(e,t)},startOrResume(e,t){if(!this.timer||this.isPaused)return this.timer?(this.isPaused=!1,this.timer.resume()):(this.isPaused=!1,this.start(e,t))},pause(){this.isPaused||this.timer&&(this.timer.pause(),this.isPaused=!0)},stop(){this.timer&&this.timer.stop(),this.isPaused=!1,this.timer=null},reset(){this.timer.reset()},get remainingTime(){return this.timer.remainingTime}},h={get name(){return"FALLBACK_PROVIDER"},isRotationEnabled:()=>!0,rotationInterval:e=>e.fallback.rotationInterval,test:(e,t)=>!0===t.wallpaper.error||function({transfer:e,route:t}){return"blocked"===e.state&&t.path.startsWith("/downloads/")}(t),nextCreative:e=>({src:`${e.host}${e.fallback.src}`,format:e.format.HTML5})};var v=r(21),f=r.n(v),w=r(32);const g=Object(w.a)({load:{path:"/api/v4/studio-wallpapers/{advertId}",pathExt:!0}});var y=r(111),b=r.n(y),O=r(897),E=r.n(O);const P=[{size:"Small",width:1280,height:800},{size:"Medium",width:1680,height:1050},{size:"Large",width:1920,height:1200}];function R(e){const t=e.src||e.asset_url,r=function(){for(let e=0;e<P.length;e++){const t=P[e];if(window.innerWidth<=t.width)return t}return E()(P)}(),a="resizedSrc"+r.size;return e[a]?e[a]:b()(t,"[SIZE]")?t.replace("[SIZE]",`${r.width}x${r.height}`):t}function _(e){return/\.html$/.test(e)?p.a.format.HTML5:p.a.format.IMAGE}const k={get name(){return"DEMO_PROVIDER"},isRotationEnabled:()=>!0,rotationInterval:e=>e.defaultRotationInterval,test:(e,t)=>!1!==f()(t,"route.params.advert_id",!1),async nextCreative(e,{route:t}){const r=t.params.advert_id,a=await g.load(null,{pathExtValues:{advertId:r}});return this.parseResponse(e,a)},parseResponse(e,t){const{href:r,src:a}=t.body;return{src:R({src:`${e.host}${a}`}),format:_(a),meta:{href:r}}}},I={get name(){return"LOCAL_DEV_PROVIDER"},isRotationEnabled:e=>e.dev.creatives.length>1,rotationInterval:e=>e.defaultRotationInterval,test:e=>e.dev.enabled&&e.dev.creatives.length>0,nextCreative(e,{wallpaper:t}){const r=t.position%e.dev.creatives.length;return e.dev.creatives[r]}},T={get name(){return"CHANNEL_PROVIDER"},isRotationEnabled(e,{account:t}){return this.creatives(e,t).length>1},rotationInterval:e=>e.plusRotationInterval,test(e,{account:t}){return this.creatives(e,t).length>0},creatives:(e,t)=>e.channelWallpapers.length>0?e.channelWallpapers:t.wallpapers,nextCreative(e,{account:t,wallpaper:r}){const a=this.creatives(e,t),n=a[r.position%a.length];return this.processCreative(n)},processCreative:e=>({format:e.wallpaperType||"image",src:R(e),meta:{href:e.href,title:f()(e,"title","")}})};var A=r(6),C=r.n(A),L=r(42);const S={get name(){return"MOBILE_PROVIDER"},isRotationEnabled:()=>!0,rotationInterval:e=>e.defaultRotationInterval,test:()=>!!C.a.isMobile,async nextCreative(e){const t=await Object(L.a)({path:e.editorialUrl,params:{utm_source:"mobile",utm_reason:null}});return this.parseResponse(e,t.body)},parseResponse(e,t){const r=t.src;return{src:R({src:`${e.host}${r}`}),format:_(r),meta:{href:f()(t,"meta.href",""),title:f()(t,"meta.title","")}}}};var j=r(26);const D={get name(){return"PLUS_PROVIDER"},isRotationEnabled:()=>!0,rotationInterval:e=>e.defaultRotationInterval,test(e,{channel:t,user:r}){const a=r.loggedIn&&Object(j.f)(r);return(t.name||a)&&0===e.channelWallpapers.length},async nextCreative(e){const t=await Object(L.a)({path:e.editorialUrl,params:{utm_source:"desktop",utm_reason:"plus"}});return this.parseResponse(e,t.body)},parseResponse(e,t){const r=t.src;return{src:R({src:`${e.host}${r}`}),format:_(r),meta:{href:f()(t,"meta.href",""),title:f()(t,"meta.title","")}}}},N={calculateInterval(e){for(const t of p.a.rotationIntervals){const[r,a]=t;if(e>=r)return a}return p.a.defaultRotationInterval},calculateSlots(e){const t=[];for(const r of Object.keys(p.a.rotationSlots)){const[a,n]=p.a.rotationSlots[r];e>=a&&e<=n&&t.push(parseInt(r,10))}return t}},W={get name(){return"ADBLOCKER_PROVIDER"},isRotationEnabled:()=>!0,rotationInterval(e,{wallpaper:t}){const r=t.position+1;return N.calculateInterval(r)},test:(e,{wallpaper:t})=>!e.isAdvertisingEnabled||!0===t.blockedByClient,async nextCreative(e,{channel:t,user:r,wallpaper:a,session:n}){const s=a.position+1,o=N.calculateSlots(s)[0],i=n.domainUserId,l=await Object(L.a)({path:e.editorialUrl,params:{duid:i,zoneId:o,utm_source:this.source(),utm_reason:this.reason(e,t,r,a)}});return this.parseResponse(e,l.body)},parseResponse(e,t){const r=t.src;return{src:R({src:`${e.host}${r}`}),format:_(r),meta:{href:f()(t,"meta.href",""),title:f()(t,"meta.title","")}}},source:()=>C.a.isMobile||C.a.isTablet?"mobile":"desktop",reason:(e,t,r,a)=>e.isAdvertisingEnabled?!0===a.blockedByClient?"privacy":null:"adblocker"};var x=r(29),U=r(64),M=r(35);const V={get name(){return"COOKIEWALL_PROVIDER"},isRotationEnabled:()=>!0,rotationInterval(e,{wallpaper:t}){const r=t.position+1;return N.calculateInterval(r)},test(){let e=!1;return x.a.getVariant(M.c)?U.a.userHasClosedBanner()&&U.a.userAllowsTracking()||(e=!0):U.a.userHasClosedBanner()&&!U.a.userAllowsTracking()&&(e=!0),e},async nextCreative(e,{session:t,wallpaper:r}){const a=r.position+1,n=N.calculateSlots(a)[0],s=t.domainUserId,o=await Object(L.a)({path:e.editorialUrl,params:{duid:s,zoneId:n,cwa:1,version:1}});return this.parseResponse(e,o.body)},parseResponse(e,t){var r,a;const{src:n}=t;return{src:R({src:`${e.host}${n}`}),format:_(n),meta:{href:(null===t||void 0===t||null===(r=t.meta)||void 0===r?void 0:r.href)||"",title:(null===t||void 0===t||null===(a=t.meta)||void 0===a?void 0:a.title)||""}}}};var B=r(89),$=r.n(B);const z=function(e){const t=(new DOMParser).parseFromString(e,"application/xml");return{impression:t.getElementsByTagName("Impression")[0].textContent,click:t.getElementsByTagName("ClickTracking")[0].textContent,start:t.querySelector('Tracking[event="start"]').textContent,firstQuartile:t.querySelector('Tracking[event="firstQuartile"]').textContent,midpoint:t.querySelector('Tracking[event="midpoint"]').textContent,thirdQuartile:t.querySelector('Tracking[event="thirdQuartile"]').textContent,complete:t.querySelector('Tracking[event="complete"]').textContent,pause:t.querySelector('Tracking[event="pause"]').textContent,resume:t.querySelector('Tracking[event="resume"]').textContent,mute:t.querySelector('Tracking[event="mute"]').textContent,unmute:t.querySelector('Tracking[event="unmute"]').textContent,rewind:t.querySelector('Tracking[event="rewind"]').textContent,fullscreen:t.querySelector('Tracking[event="unmute"]').textContent}},H=function(e,t,r){!function(e){if(!e)return;let t=new Image;t.onload=()=>{t.onload=null,t=null},t.setAttribute("src",e)}(f()(e,`['${r}']['${t}']`))};var q=r(31);function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const G={get name(){return"ADS_PROVIDER"},isRotationEnabled:()=>!0,rotationInterval(e,{wallpaper:t}){const r=t.position+1;return N.calculateInterval(r)},async nextCreative(e,{session:t,wallpaper:r}){const a=r.position+1,n=N.calculateSlots(a),s=this.buildAdParams(e,n,t),o=await this.sendRequest(e,s);return await this.parseResponse(o,e,n,a)},buildAdParams(e,t,r){const a=$.a.parse(location.search),n={};a.adzerk_origin_ip&&(n.ip=a.adzerk_origin_ip);const s=this.buildParams(e,t,r);return K({},n,{consent:{gdpr:!0},placements:[K({},s.placement,{divName:e.adzerk.placements.iframe,adTypes:[e.adzerk.adTypes.wallpaper]})],keywords:s.keywords,user:{key:"sp-"+r.domainUserId}})},buildVastParams(e,t,r){const a=this.buildParams(e,t);return{consent:{gdpr:!0},placements:[K({},a.placement,{divName:e.adzerk.placements.video,adTypes:[e.adzerk.adTypes.video],adId:r})],keywords:a.keywords}},buildParams(e,t,r={}){const a=$.a.parse(location.search),n=f()(e,"session.user.acceptedLanguages[0]",r.language),s=Array(10).fill(0).map((e,t)=>t+70),o=Array(201).fill(0).map((e,t)=>t+800),i={placement:{networkId:e.adzerk.networkId,siteId:e.adzerk.siteId,zoneIds:t,eventIds:s.concat(o)},keywords:["user_locale:"+n]},l=parseInt(a.ad_id,10);return isFinite(l)&&(i.placement.adId=l,i.keywords.push("test")),C.a.isTablet&&i.keywords.push("ipad"),i},sendRequest:(e,t)=>Object(L.a)({path:""+e.adzerk.api,method:"post",params:t}),async parseResponse(e,t,r,a){const n=t.adzerk.placements.iframe,s=f()(e,"body.decisions."+n,null);if(null===s)throw new Error("NoAdverts");q.a.addMetadata("creative_id",s.adId),q.a.addMetadata("flight_id",s.flightId);const o=f()(s,"contents[0].data",null);if(null===o)throw new Error("NoCreative");const i=R({src:`${t.host}${o.ctDaveURL}`});q.a.addMetadata("creative_src",i);const l=this.processCustomEvents(s.events),c=await this.processVastTrackers(o,t,r,a);return{id:s.adId,flightId:s.flightId,src:i,format:o.ctFormat,clickUrl:s.clickUrl,impressionTrackers:[s.impressionUrl,o.ct3rdPartyTrack,o.ct3rdPartyTrack2,o.ct3rdPartyTrack3,o.ct3rdPartyTrack4,o.ct3rdPartyTrack5].filter(Boolean),vastTrackers:c,customEvents:l,scripts:[o.ctMOATTrack].filter(Boolean),meta:{href:s.clickUrl,title:f()(o,"ctCreativeTitle","")}}},processCustomEvents:(e=[])=>e.reduce((e,t)=>(e[t.id]=t.url,e),{}),processVastTrackers(e,t,r){const a=f()(e,"ctVastIds","");if(0===a.length)return null;const n=a.split(",").map(e=>parseInt(e,10)).filter(Boolean).map(async e=>{const a=this.buildVastParams(t,r,e),n=await this.sendRequest(t,a),s=t.adzerk.placements.video,o=f()(n,`body.decisions.${s}.contents[0]`),i=f()(o,"data.ctadTagURI"),l=f()(o,"body");if(!o)throw new Error("NoVastTracker for VAST id "+e);if(!i)throw new Error("NoVastURI for VAST id "+e);if(!l)throw new Error("NoVastBody for VAST id "+e);return{videoUrl:i,body:l}});return Promise.all(n).then(e=>e.reduce((e,t)=>(e[t.videoUrl]=z(t.body),e),{}))}};var J=r(23);function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}const Y=c.a.generateTypes(["PAUSE_WALLPAPER_ROTATION","RESUME_WALLPAPER_ROTATION","ROTATE_WALLPAPER","STOP_WALLPAPER_ROTATION","WALLPAPER_ERROR","WALLPAPER_BLOCKED_BY_CLIENT"]),Z=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},l.a,{channelWallpapers:i()(l.a.channelWallpapers)},p.a);function X(){return async(e,t)=>{const r=t();try{const t=function(e,t){return h.test(e,t)?h:k.test(e,t)?k:I.test(e,t)?I:T.test(e,t)?T:S.test(e,t)?S:D.test(e,t)?D:V.test(e,t)?V:W.test(e,t)?W:G}(Z,r);a=t.rotationInterval(Z,r),n=()=>e(X()),m.stop(),m.start(a,n);const s=t.isRotationEnabled(Z,r),o=r.wallpaper.providerName!==t.name;if(s||o){const a=await t.nextCreative(Z,r);return e({type:Y.ROTATE_WALLPAPER,creative:a,isRotationEnabled:s,providerName:t.name})}}catch(s){if(s.status===J.a.BLOCKED_BY_CLIENT)return e({type:Y.WALLPAPER_BLOCKED_BY_CLIENT}),void e(X());q.a.track(s),e({type:Y.WALLPAPER_ERROR}),e(X())}var a,n}}const ee=c.a.generateActions({pauseRotation:function(e=!1){return t=>(m.pause(),t({type:Y.PAUSE_WALLPAPER_ROTATION,isHidden:e}))},rotateWallpaper:X,startOrResumeRotation:function(e){return t=>(m.startOrResume(e.rotationInterval,()=>t(X())),t({type:Y.RESUME_WALLPAPER_ROTATION}))},showFallbackWallpaper:function(){return e=>{e({type:Y.WALLPAPER_ERROR}),e(X())}}});var te={creative:null,error:!1,blockedByClient:!1,isAdvertisingEnabled:!1,isHidden:!1,isRotationEnabled:!1,isRotationPaused:!1,position:0,providerName:null};function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}a.a.register("wallpaper",(function(e=te,t){const{type:r}=t;switch(r){case Y.ROTATE_WALLPAPER:return ae({},e,{creative:t.creative,error:!1,isHidden:!1,isRotationEnabled:t.isRotationEnabled,isRotationPaused:!1,position:e.position+1,providerName:t.providerName});case Y.PAUSE_WALLPAPER_ROTATION:return ae({},e,{isHidden:t.isHidden,isRotationPaused:!0});case Y.RESUME_WALLPAPER_ROTATION:return ae({},e,{isRotationPaused:!1});case Y.WALLPAPER_BLOCKED_BY_CLIENT:return ae({},e,{blockedByClient:!0});case Y.WALLPAPER_ERROR:return ae({},e,{error:!0})}return e}));var ne=r(0),se=r.n(ne),oe=r(22),ie=r(898),le=r(684),ce=r(20),pe=r.n(ce),de=r(100);const ue={sendWallpaperImpressionHits(e){100*Math.random()>5||function(e){const t=e.providerName;de.a.send(["client_wallpaper_rotations","wallpaper_"+t.toLowerCase()])}(e)}};function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}const he=function(e,t){const r=e[t];r&&function(e){if(!e)return;let t=new Image;t.onload=()=>{t.onload=null,t=null},t.setAttribute("src",e)}(r)},ve=function(e){const t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({sid:e.session.domainUserId,cid:e.wallpaper.creative.id},e.event);return Object(L.a)({path:p.a.walter.api,method:"post",params:t})};var fe=r(558),we=r(15),ge=r(12),ye=r(9);const be=Date.now(),Oe={api_toggleDragOver(){fe.a.show()},api_showDropZone(){fe.a.show()},api_hideDropZone(){},api_addFiles(...e){fe.a.target&&fe.a.target.addFiles(e),fe.a.hide()},api_show(){ge.a.dispatch(ye.a.Layout.showUI())},api_hide(){ge.a.dispatch(ye.a.Layout.hideUI())},api_openPanel(e,t=""){if(!e.match(/^\/(about|pro|products|sign-in|sign-up)/i))return;const r=t?{search:"trk="+t}:{};we.a.navigateTo(e,!1,r)},api_pauseTimer(){ge.a.dispatch(ee.pauseRotation())},api_resumeTimer(){const{wallpaper:e}=ge.a.getState();ge.a.dispatch(ee.startOrResumeRotation(e))},api_resetTimer(){m.reset()},api_change(){ge.a.dispatch(ee.rotateWallpaper())},api_forceChange(){ge.a.dispatch(ee.rotateWallpaper())},api_setWallpaperUIStyle(e={}){ge.a.dispatch(ye.a.Layout.setWallpaperUIStyle(e))},api_setAppTheme(e){document.body.className=`${document.body.className} ${e.className}`;const t=document.createElement("link");t.setAttribute("id","wallpaper-theme-"+e.className),t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e.href),document.getElementsByTagName("head")[0].appendChild(t)},api_vast(e,t){const{wallpaper:{creative:r}}=ge.a.getState();H(r.vastTrackers,e,t)},api_getState(e){const{wallpaper:t}=ge.a.getState();return this.getCurrentState(t.creative,e)},api_sendCustomEvent(e){const{wallpaper:{creative:t}}=ge.a.getState();he(t.customEvents,e)},api_sendCustomEventWalter(e){const{wallpaper:t,session:r}=ge.a.getState();ve({event:e,wallpaper:t,session:r})},getCurrentState(e,t){const{route:r,session:a,wallpaper:n}=ge.a.getState(),s=document.querySelector(".transfer").getBoundingClientRect(),o=document.querySelector(".nav").getBoundingClientRect(),i=n.position-1;return{_analytics:e.scripts,ads_viewed:i,requester:t,geo:a.region,state:r.path.match(/download/)?"download":"upload",panel:r.isPanelOpen,language:a.language,time_on_site:(Date.now()-be)/1e3,remaining:m.remainingTime||30,user_agent:C.a.identity,_click:f()(e,"meta.href"),position:{x:Math.round(s.left),y:Math.round(s.top),width:Math.round(s.width),height:Math.round(s.height)},nav_position:{x:Math.round(o.left),y:Math.round(o.top),width:Math.round(o.width),height:Math.round(o.height)}}}};let Ee=null,Pe=null;function Re(e){return new URL(e.src).origin}function _e(e){if(Re(Ee)!==e.origin)return!1;try{const{method:t,data:r}=function({data:e}){let t={};try{t=e.raw?e:JSON.parse(e)}catch(a){throw new Error("UnableToParseMessage: "+e)}if(!t.command)throw new Error("EmptyWallpaperCommand: "+e);const r="api_"+t.command;if(!Oe[r])throw new Error("MethodNotFound: "+r);return{method:r,data:t.data}}(e),a=Oe[t](...r);"api_getState"===t&&ke(a,"update")}catch(t){q.a.track(t)}}function ke(e,t="start"){Pe.contentWindow.postMessage(function(e,...t){return JSON.stringify({command:e,data:t})}(t,e),Re(Ee))}const Ie={init(e,t){Ee=t,Pe=e,window.addEventListener("message",_e),ke(Oe.getCurrentState(Ee))},stop(){Pe=null,Ee=null,window.removeEventListener("message",_e)}},Te={load(e){switch(e.format){case p.a.format.IMAGE:return this.loadImage(e.src);case p.a.format.HTML5:return this.loadHTML5();case p.a.format.VIDEO:return this.loadVideo(e.src);default:throw new Error("UnsupportedCreativeType "+e.format)}},loadImage:e=>new Promise((t,r)=>{const a=new Image;a.onload=()=>t(),a.onerror=e=>r(e),a.setAttribute("src",e)}),loadVideo(e){return new Promise((t,r)=>{const a=this.getElement("video");a.onloadeddata=()=>{this.cleanUpElement(a),t()},a.onerror=e=>{this.cleanUpElement(a),r(e)},a.setAttribute("src",e),document.body.appendChild(a)})},loadHTML5:()=>Promise.resolve(),getElement(e){const t=document.getElementById("element-preloader");t&&document.body.removeChild(t);const r=document.createElement(e);return r.setAttribute("id","element-preloader"),r.setAttribute("style","display: none"),r},cleanUpElement(e){document.body.removeChild(e),e=null}};function Ae(e){const t=new URL(window.location),r=e.match(/\?/)?"&":"?";return`${e}${r}_origin=${t.origin}`}var Ce=r(7);class Le extends se.a.PureComponent{constructor(...e){super(...e),s()(this,"wrapperNode",se.a.createRef()),s()(this,"frameNode",se.a.createRef()),s()(this,"initWallpaper",()=>{this.createTrackingTags(),Ie.init(this.frameNode.current,this.props.creative)})}createTrackingTags(){const{creative:e}=this.props;if(!e.impressionTrackers)return null;e.impressionTrackers.forEach(e=>{const t=Object(Ce.a)(e);this.wrapperNode.current.appendChild(t)})}render(){const{creative:e}=this.props;return se.a.createElement("div",{className:"wallpaper__html",ref:this.wrapperNode},se.a.createElement("iframe",{allow:"autoplay; camera",frameBorder:"0",onLoad:this.initWallpaper,ref:this.frameNode,scrolling:"no",src:Ae(e.src),title:"wallpaper-frame",id:"wallpaper-frame"}))}}var Se=Le;class je extends se.a.PureComponent{constructor(...e){super(...e),s()(this,"handleImageClick",e=>{e.preventDefault();const{href:t}=this.props.creative.meta;if(!t)return;const r=window.open(t);r&&(r.opener=null)})}render(){const{src:e,meta:t}=this.props.creative,r=pe()("wallpaper__image",{"wallpaper--is-clickable":t.href});return se.a.createElement("div",{className:r,onClick:this.handleImageClick,onKeyPress:this.handleImageClick,role:"presentation",style:{backgroundImage:`url(${e})`}})}}var De=je;class Ne extends se.a.PureComponent{constructor(...e){super(...e),s()(this,"handleVideoClick",e=>{e.preventDefault();const{href:t}=this.props.creative.meta;if(!t)return;const r=window.open(t);r&&(r.opener=null)})}render(){const{src:e,meta:t}=this.props.creative,r=pe()("wallpaper__video",{"wallpaper--is-clickable":t.href});return se.a.createElement("video",{className:r,onClick:this.handleVideoClick,onKeyPress:this.handleVideoClick,src:e,autoPlay:!0,muted:!0,loop:!0})}}var We=Ne,xe=r(27);r(948);class Ue extends se.a.PureComponent{constructor(...e){super(...e),s()(this,"state",{creative:null,position:0})}async componentDidMount(){const{route:e}=this.props;await this.props.rotateWallpaper(),e.isPanelOpen&&this.props.pauseRotation()}componentDidUpdate(e){const{route:t,wallpaper:r}=this.props,a=f()(t,"params.advert_id");a&&f()(e,"route.params.advert_id")!==a&&this.props.rotateWallpaper(),f()(e,"wallpaper.position")!==r.position&&this.preloadCreative(),r.isRotationEnabled&&!r.isHidden&&(e.route.isPanelOpen!==t.isPanelOpen&&t.isPanelOpen&&!r.isRotationPaused&&this.props.pauseRotation(),e.route.isPanelOpen!==t.isPanelOpen&&!t.isPanelOpen&&r.isRotationPaused&&this.props.startOrResumeRotation(r))}componentDidCatch(e){xe.a.error(e),q.a.track(e),this.props.showFallbackWallpaper()}static getDerivedStateFromError(){return{creative:null}}async preloadCreative(){const{wallpaper:e}=this.props;try{Ie.stop(),await Te.load(e.creative),this.setState({creative:e.creative,position:e.position}),ue.sendWallpaperImpressionHits(e)}catch(t){q.a.track(t),this.props.rotateWallpaper()}}closePanel(){we.a.navigateTo(we.a.getLastRoute("transfer","/"))}renderWallpaperLink(){if(!this.state.creative.meta)return null;const{href:e,title:t}=this.state.creative.meta,r=t&&t.length>150?t.slice(0,150)+"...":t;return e&&t?se.a.createElement("a",{href:e,rel:"noopener noreferrer",className:"wallpaper__title",target:"_blank",title:t},r):t?se.a.createElement("span",{className:"wallpaper__title",title:t},r):null}renderBlockingLayer(){const{route:e}=this.props;return e.isPanelOpen?se.a.createElement("div",{className:"wallpaper__cover",onClick:this.closePanel,onKeyPress:this.closePanel,role:"link",tabIndex:"0"}):null}renderWallpaper(){const{creative:e}=this.state;switch(e.format){case p.a.format.IMAGE:return se.a.createElement(De,{creative:e});case p.a.format.HTML5:return se.a.createElement(Se,{creative:e});case p.a.format.VIDEO:return se.a.createElement(We,{creative:e})}}render(){const{route:e}=this.props,{creative:t,position:r}=this.state,a=pe()("wallpaper",{"wallpaper--no-transition":!e.isPanelOpen,"wallpaper--half-panel":e.isPanelHalfOpen,"wallpaper--full-panel":e.isPanelFullOpen});return se.a.createElement("div",{className:a},this.renderBlockingLayer(),t&&se.a.createElement(ie.a,{appear:!0,component:null},se.a.createElement(le.a,{key:"creative.src-"+r,timeout:p.a.transition.duration,className:"wallpaper__content",classNames:{appear:"wallpaper__content--appear",appearActive:"wallpaper__content--appear-active",appearDone:"wallpaper__content--appear-done",enter:"wallpaper__content--enter",enterActive:"wallpaper__content--enter-active",enterDone:"wallpaper__content--enter-done",exit:"wallpaper__content--exit",exitActive:"wallpaper__content--exit-active",exitDone:"wallpaper__content--exit-done"}},se.a.createElement("div",null,this.renderWallpaper(),this.renderWallpaperLink()))))}}Ue.defaultProps={wallpaper:{}};const Me={determineProviderAndRotate:ee.determineProviderAndRotate,pauseRotation:ee.pauseRotation,rotateWallpaper:ee.rotateWallpaper,showFallbackWallpaper:ee.showFallbackWallpaper,startOrResumeRotation:ee.startOrResumeRotation};var Ve=Object(oe.b)(({route:e,wallpaper:t})=>({route:e,wallpaper:t}),Me)(Ue)}}]);
//# sourceMappingURL=wallpaper-eff876c9c14be4d28c49.es6.js.map