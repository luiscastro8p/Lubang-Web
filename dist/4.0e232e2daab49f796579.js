(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"/wl/":function(t,i,e){"use strict";e.d(i,"a",function(){return o});var s=e("E+ha"),o=function(){function t(t,i,e,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===s&&(s=0),this.left=t,this.right=t+e,this.top=i,this.bottom=i+s}return Object.defineProperty(t.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0}),t.prototype.getCentre=function(){return s.a.instance.borrow(this.left+this.width/2,this.top+this.height/2)},t}()},"1NRv":function(t,i,e){"use strict";e.d(i,"a",function(){return o});var s=e("/wl/"),o=function(){function t(t,i,e,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===s&&(s=0),this.x=+t,this.y=+i,this.w=+e,this.h=+s}return t.prototype.toBounds=function(){return new s.a(this.x,this.y,this.w,this.h)},t.prototype.isInitialized=function(){return 0!==this.x&&0!==this.y&&0!==this.w&&0!==this.h},t}()},"E+ha":function(t,i,e){"use strict";e.d(i,"a",function(){return o});var s=e("suHk"),o=function(){function t(i){t._instance=this;for(var e=this.firstAvailable=new s.a,o=1;o<i;o++){var n=new s.a;e.next=n,e=n}}return Object.defineProperty(t,"instance",{get:function(){return t._instance},enumerable:!0,configurable:!0}),t.prototype.borrow=function(t,i){if(null==this.firstAvailable)throw"Pool exhausted";this.borrowed++;var e=this.firstAvailable;return this.firstAvailable=e.next,e.x=t,e.y=i,e},t.prototype.returnPoint=function(t){this.borrowed--,t.x=0,t.y=0,t.next=this.firstAvailable,this.firstAvailable=t},t}()},ItAH:function(t,i,e){"use strict";e.d(i,"a",function(){return s}),e("Xfwv");var s=function(){return function(){}}()},TRX7:function(t,i,e){"use strict";e.d(i,"a",function(){return s});var s=function(){return function(){this.strokeWidth=1,this.strokeColor="rgba(255,255,255,1)",this.dragIconStrokeWidth=1,this.dragIconStrokeColor="rgba(0,0,0,1)",this.dragIconFillColor="rgba(255,255,255,1)"}}()},"W+o+":function(t,i,e){"use strict";e.d(i,"a",function(){return o});var s=e("TRX7"),o=function(){function t(){this.canvasWidth=300,this.canvasHeight=300,this.dynamicSizing=!1,this.width=200,this.height=200,this.minWidth=50,this.minHeight=50,this.minWithRelativeToResolution=!0,this.croppedWidth=100,this.croppedHeight=100,this.cropperDrawSettings=new s.a,this.touchRadius=20,this.noFileInput=!1,this.allowedFilesRegex=/\.(jpe?g|png|gif)$/i,this.cropOnResize=!0,this.preserveSize=!1,this.compressRatio=1,this._rounded=!1,this._keepAspect=!0}return Object.defineProperty(t.prototype,"rounded",{get:function(){return this._rounded},set:function(t){this._rounded=t,t&&(this._keepAspect=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keepAspect",{get:function(){return this._keepAspect},set:function(t){if(!1===t&&this._rounded)throw new Error("Cannot set keep aspect to false on rounded cropper. Ellipsis not supported");this._keepAspect=t},enumerable:!0,configurable:!0}),t}()},Xfwv:function(t,i,e){"use strict";e("CcnG"),e("pE7p"),e("W+o+"),e("mrSG"),Number,e("1NRv")},pE7p:function(t,i,e){"use strict";var s=e("mrSG"),o=e("/wl/"),n=e("suHk"),r=e("W+o+"),h=function(){function t(t,i,e,s){this.cropperSettings=new r.a,this.over=!1,this.drag=!1,this._position=new n.a(t,i),this.offset=new n.a(0,0),this.radius=e,this.cropperSettings=s}return t.prototype.setDrag=function(t){this.drag=t,this.setOver(t)},t.prototype.draw=function(t){},t.prototype.setOver=function(t){this.over=t},t.prototype.touchInBounds=function(t,i){return t>this.position.x-this.radius+this.offset.x&&t<this.position.x+this.radius+this.offset.x&&i>this.position.y-this.radius+this.offset.y&&i<this.position.y+this.radius+this.offset.y},Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!0,configurable:!0}),t.prototype.setPosition=function(t,i){this._position.x=t,this._position.y=i},t}(),a=function(t){function i(i,e,s,o){return t.call(this,i,e,s,o)||this}return Object(s.__extends)(i,t),i.prototype.drawCornerBorder=function(t){var i=10;(this.over||this.drag)&&(i=12);var e=1,s=1;if(this.horizontalNeighbour.position.x<this.position.x&&(e=-1),this.verticalNeighbour.position.y<this.position.y&&(s=-1),this.cropperSettings.rounded){var o=this.position.x-this.horizontalNeighbour.position.x,n=this.position.y-this.verticalNeighbour.position.y,r=Math.round(Math.sin(Math.PI/2)*Math.abs(o/2))/4,h=Math.round(Math.sin(Math.PI/2)*Math.abs(n/2))/4;this.offset.x=e>0?r:-r,this.offset.y=s>0?h:-h}else this.offset.x=0,this.offset.y=0;t.beginPath(),t.lineJoin="miter",t.moveTo(this.position.x+this.offset.x,this.position.y+this.offset.y),t.lineTo(this.position.x+this.offset.x+i*e,this.position.y+this.offset.y),t.lineTo(this.position.x+this.offset.x+i*e,this.position.y+this.offset.y+i*s),t.lineTo(this.position.x+this.offset.x,this.position.y+this.offset.y+i*s),t.lineTo(this.position.x+this.offset.x,this.position.y+this.offset.y),t.closePath(),t.lineWidth=this.cropperSettings.cropperDrawSettings.strokeWidth,t.strokeStyle=this.cropperSettings.cropperDrawSettings.strokeColor,t.stroke()},i.prototype.drawCornerFill=function(t){var i=10;(this.over||this.drag)&&(i=12);var e=1,s=1;this.horizontalNeighbour.position.x<this.position.x&&(e=-1),this.verticalNeighbour.position.y<this.position.y&&(s=-1),t.beginPath(),t.moveTo(this.position.x+this.offset.x,this.position.y+this.offset.y),t.lineTo(this.position.x+this.offset.x+i*e,this.position.y+this.offset.y),t.lineTo(this.position.x+this.offset.x+i*e,this.position.y+this.offset.y+i*s),t.lineTo(this.position.x+this.offset.x,this.position.y+this.offset.y+i*s),t.lineTo(this.position.x+this.offset.x,this.position.y+this.offset.y),t.closePath(),t.fillStyle="rgba(255,255,255,.7)",t.fill()},i.prototype.moveX=function(t){this.setPosition(t,this.position.y)},i.prototype.moveY=function(t){this.setPosition(this.position.x,t)},i.prototype.move=function(t,i){this.setPosition(t,i),this.verticalNeighbour.moveX(t),this.horizontalNeighbour.moveY(i)},i.prototype.addHorizontalNeighbour=function(t){this.horizontalNeighbour=t},i.prototype.addVerticalNeighbour=function(t){this.verticalNeighbour=t},i.prototype.getHorizontalNeighbour=function(){return this.horizontalNeighbour},i.prototype.getVerticalNeighbour=function(){return this.verticalNeighbour},i.prototype.draw=function(t){this.drawCornerFill(t),this.drawCornerBorder(t)},i}(h),c=function(){return function(t,i,e){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),this.id=e,this.x=t,this.y=i}}(),p=e("E+ha"),u=function(t){function i(i,e,s,o){var n=t.call(this,i,e,s,o)||this;return n.iconPoints=[],n.scaledIconPoints=[],n.getDragIconPoints(n.iconPoints,1),n.getDragIconPoints(n.scaledIconPoints,1.2),n}return Object(s.__extends)(i,t),i.prototype.draw=function(t){this.drawIcon(t,this.over||this.drag?this.scaledIconPoints:this.iconPoints)},i.prototype.getDragIconPoints=function(t,i){var e=17*i,s=14*i,o=8*i,n=4*i;t.push(p.a.instance.borrow(-n/2,e-o)),t.push(p.a.instance.borrow(-s/2,e-o)),t.push(p.a.instance.borrow(0,e)),t.push(p.a.instance.borrow(s/2,e-o)),t.push(p.a.instance.borrow(n/2,e-o)),t.push(p.a.instance.borrow(n/2,n/2)),t.push(p.a.instance.borrow(e-o,n/2)),t.push(p.a.instance.borrow(e-o,s/2)),t.push(p.a.instance.borrow(e,0)),t.push(p.a.instance.borrow(e-o,-s/2)),t.push(p.a.instance.borrow(e-o,-n/2)),t.push(p.a.instance.borrow(n/2,-n/2)),t.push(p.a.instance.borrow(n/2,-e+o)),t.push(p.a.instance.borrow(s/2,-e+o)),t.push(p.a.instance.borrow(0,-e)),t.push(p.a.instance.borrow(-s/2,-e+o)),t.push(p.a.instance.borrow(-n/2,-e+o)),t.push(p.a.instance.borrow(-n/2,-n/2)),t.push(p.a.instance.borrow(-e+o,-n/2)),t.push(p.a.instance.borrow(-e+o,-s/2)),t.push(p.a.instance.borrow(-e,0)),t.push(p.a.instance.borrow(-e+o,s/2)),t.push(p.a.instance.borrow(-e+o,n/2)),t.push(p.a.instance.borrow(-n/2,n/2))},i.prototype.drawIcon=function(t,i){t.beginPath(),t.moveTo(i[0].x+this.position.x,i[0].y+this.position.y);for(var e=0;e<i.length;e++){var s=i[e];t.lineTo(s.x+this.position.x,s.y+this.position.y)}t.closePath(),t.fillStyle=this.cropperSettings.cropperDrawSettings.dragIconFillColor,t.fill(),t.lineWidth=this.cropperSettings.cropperDrawSettings.dragIconStrokeWidth,t.strokeStyle=this.cropperSettings.cropperDrawSettings.dragIconStrokeColor,t.stroke()},i.prototype.recalculatePosition=function(t){var i=t.getCentre();this.setPosition(i.x,i.y),p.a.instance.returnPoint(i)},i}(h),g=function(){return function(){}}(),d=function(){function t(){}return t.setPressed=function(t){this.pressed=t},t.setReleased=function(t){},t.setOver=function(t){this.over=t},t.setStyle=function(t,i){},t.share={},t}();e.d(i,"a",function(){return l});var l=function(t){function i(i){var e=t.call(this)||this,s=i.width,o=i.height,n=i.keepAspect,r=i.touchRadius,h=i.minWidth,c=i.minHeight,g=i.croppedWidth,d=i.croppedHeight;return e.cropperSettings=i,e.crop=e,e.x=0,e.y=0,void 0===s&&(e.width=100),void 0===o&&(e.height=50),void 0===n&&(e.keepAspect=!0),void 0===r&&(e.touchRadius=20),e.minWidth=h,e.minHeight=c,e.keepAspect=!1,e.aspectRatio=0,e.currentDragTouches=[],e.isMouseDown=!1,e.ratioW=1,e.ratioH=1,e.fileType=i.fileType,e.imageSet=!1,e.pointPool=new p.a(200),e.tl=new a(0,0,r,e.cropperSettings),e.tr=new a(0+s,0,r,e.cropperSettings),e.bl=new a(0,0+o,r,e.cropperSettings),e.br=new a(0+s,0+o,r,e.cropperSettings),e.tl.addHorizontalNeighbour(e.tr),e.tl.addVerticalNeighbour(e.bl),e.tr.addHorizontalNeighbour(e.tl),e.tr.addVerticalNeighbour(e.br),e.bl.addHorizontalNeighbour(e.br),e.bl.addVerticalNeighbour(e.tl),e.br.addHorizontalNeighbour(e.bl),e.br.addVerticalNeighbour(e.tr),e.markers=[e.tl,e.tr,e.bl,e.br],e.center=new u(0+s/2,0+o/2,r,e.cropperSettings),e.keepAspect=n,e.aspectRatio=o/s,e.croppedImage=new Image,e.currentlyInteracting=!1,e.cropWidth=g,e.cropHeight=d,e}return Object(s.__extends)(i,t),i.sign=function(t){return+t===t?0===t?t:t>0?1:-1:NaN},i.getMousePos=function(t,i){var e=t.getBoundingClientRect();return p.a.instance.borrow(i.clientX-e.left,i.clientY-e.top)},i.getTouchPos=function(t,i){var e=t.getBoundingClientRect();return p.a.instance.borrow(i.clientX-e.left,i.clientY-e.top)},i.detectVerticalSquash=function(t){var i=t.height,e=document.createElement("canvas");e.width=1,e.height=i;var s=e.getContext("2d");s.drawImage(t,0,0);var o=s.getImageData(0,0,1,i);if(o){for(var n=o.data,r=0,h=i,a=i;a>r;)0===n[4*(a-1)+3]?h=a:r=a,a=h+r>>1;var c=a/i;return 0===c?1:c}return 1},i.prototype.getDataUriMimeType=function(t){var i=t.substring(0,50),e="image/png",s=RegExp(/^(data:)([\w\/\+]+);(charset=[\w-]+|base64).*,(.*)/gi).exec(i);return s&&s[2]&&"image/jpg"==(e=s[2])&&(e="image/jpeg"),e},i.prototype.prepare=function(t){this.buffer=document.createElement("canvas"),this.cropCanvas=document.createElement("canvas");var i=t.parentElement?t.parentElement.clientWidth:0;i>0&&this.cropperSettings.dynamicSizing?(this.cropCanvas.width=i,this.buffer.width=i,t.width=i):(this.cropCanvas.width=this.cropWidth,this.buffer.width=t.width),this.cropCanvas.height=this.cropHeight,this.buffer.height=t.height,this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.draw(this.ctx)},i.prototype.resizeCanvas=function(t,i,e){void 0===e&&(e=!1),this.canvas.width=this.cropCanvas.width=this.width=this.canvasWidth=this.buffer.width=t,this.canvas.height=this.cropCanvas.height=this.height=this.canvasHeight=this.buffer.height=i,e&&this.setImage(this.srcImage)},i.prototype.reset=function(){this.setImage(void 0)},i.prototype.draw=function(t){var i=this.getBounds();if(this.srcImage){t.clearRect(0,0,this.canvasWidth,this.canvasHeight);var e=this.srcImage.height/this.srcImage.width,s=this.canvasHeight/this.canvasWidth,o=this.canvasWidth,n=this.canvasHeight;s>e?(o=this.canvasWidth,n=this.canvasWidth*e):(n=this.canvasHeight,o=this.canvasHeight/e),this.ratioW=o/this.srcImage.width,this.ratioH=n/this.srcImage.height,s<e?this.drawImageIOSFix(t,this.srcImage,0,0,this.srcImage.width,this.srcImage.height,this.buffer.width/2-o/2,0,o,n):this.drawImageIOSFix(t,this.srcImage,0,0,this.srcImage.width,this.srcImage.height,0,this.buffer.height/2-n/2,o,n),this.buffer.getContext("2d").drawImage(this.canvas,0,0,this.canvasWidth,this.canvasHeight),t.lineWidth=this.cropperSettings.cropperDrawSettings.strokeWidth,t.strokeStyle=this.cropperSettings.cropperDrawSettings.strokeColor,this.cropperSettings.rounded?(t.beginPath(),t.arc(i.left+i.width/2,i.top+i.height/2,i.width/2,0,2*Math.PI,!0),t.closePath(),t.stroke()):(t.fillStyle="rgba(0, 0, 0, 0.6)",t.fillRect(0,0,this.canvasWidth,this.canvasHeight),t.drawImage(this.buffer,i.left,i.top,Math.max(i.width,1),Math.max(i.height,1),i.left,i.top,i.width,i.height),t.strokeRect(i.left,i.top,i.width,i.height));for(var r=0;r<this.markers.length;r++)this.markers[r].draw(t);this.center.draw(t)}else t.fillStyle="rgba(192,192,192,1)",t.fillRect(0,0,this.canvas.width,this.canvas.height)},i.prototype.dragCenter=function(t,i,e){var s=this.getBounds(),o=t-s.width/2,n=i+s.height/2;t+s.width/2>=this.maxXClamp&&(t=this.maxXClamp-s.width/2),o<=this.minXClamp&&(t=s.width/2+this.minXClamp),i-s.height/2<this.minYClamp&&(i=s.height/2+this.minYClamp),n>=this.maxYClamp&&(i=this.maxYClamp-s.height/2),this.tl.moveX(t-s.width/2),this.tl.moveY(i-s.height/2),this.tr.moveX(t+s.width/2),this.tr.moveY(i-s.height/2),this.bl.moveX(t-s.width/2),this.bl.moveY(i+s.height/2),this.br.moveX(t+s.width/2),this.br.moveY(i+s.height/2),e.setPosition(t,i)},i.prototype.enforceMinSize=function(t,i,e){var s=t-e.getHorizontalNeighbour().position.x,o=i-e.getVerticalNeighbour().position.y,n=this.minWidth-Math.abs(s),r=this.minHeight-Math.abs(o);return 0===s||0===o?p.a.instance.borrow(t=e.position.x,i=e.position.y):(this.keepAspect?n>0&&r/this.aspectRatio>0?n>r/this.aspectRatio?s<0?(t-=n,o<0?i-=n*this.aspectRatio:i+=n*this.aspectRatio):(t+=n,o<0?i-=n*this.aspectRatio:i+=n*this.aspectRatio):o<0?(i-=r,s<0?t-=r/this.aspectRatio:t+=r/this.aspectRatio):(i+=r,s<0?t-=r/this.aspectRatio:t+=r/this.aspectRatio):n>0?s<0?(t-=n,o<0?i-=n*this.aspectRatio:i+=n*this.aspectRatio):(t+=n,o<0?i-=n*this.aspectRatio:i+=n*this.aspectRatio):r>0&&(o<0?(i-=r,s<0?t-=r/this.aspectRatio:t+=r/this.aspectRatio):(i+=r,s<0?t-=r/this.aspectRatio:t+=r/this.aspectRatio)):(n>0&&(s<0?t-=n:t+=n),r>0&&(o<0?i-=r:i+=r)),(t<this.minXClamp||t>this.maxXClamp||i<this.minYClamp||i>this.maxYClamp)&&(t=e.position.x,i=e.position.y),p.a.instance.borrow(t,i))},i.prototype.dragCorner=function(t,i,e){var s,o=0,n=0,r=0,h=0,a=0;if(this.keepAspect)if(o=(s=e.getHorizontalNeighbour().getVerticalNeighbour()).position.x,n=s.position.y,t<=s.position.x)if(i<=s.position.y)if((a=this.getSide(p.a.instance.borrow(o-100/this.aspectRatio,n-100/this.aspectRatio*this.aspectRatio),s.position,p.a.instance.borrow(t,i)))>0){r=Math.abs(s.position.y-i);var c=this.enforceMinSize(s.position.x-(h=r/this.aspectRatio),s.position.y-r,e);e.move(c.x,c.y),p.a.instance.returnPoint(c)}else a<0&&(h=Math.abs(s.position.x-t),c=this.enforceMinSize(s.position.x-h,s.position.y-(r=h*this.aspectRatio),e),e.move(c.x,c.y),p.a.instance.returnPoint(c));else(a=this.getSide(p.a.instance.borrow(o-100/this.aspectRatio,n+100/this.aspectRatio*this.aspectRatio),s.position,p.a.instance.borrow(t,i)))>0?(h=Math.abs(s.position.x-t),c=this.enforceMinSize(s.position.x-h,s.position.y+(r=h*this.aspectRatio),e),e.move(c.x,c.y),p.a.instance.returnPoint(c)):a<0&&(r=Math.abs(s.position.y-i),c=this.enforceMinSize(s.position.x-(h=r/this.aspectRatio),s.position.y+r,e),e.move(c.x,c.y),p.a.instance.returnPoint(c));else i<=s.position.y?(a=this.getSide(p.a.instance.borrow(o+100/this.aspectRatio,n-100/this.aspectRatio*this.aspectRatio),s.position,p.a.instance.borrow(t,i)))<0?(r=Math.abs(s.position.y-i),c=this.enforceMinSize(s.position.x+(h=r/this.aspectRatio),s.position.y-r,e),e.move(c.x,c.y),p.a.instance.returnPoint(c)):a>0&&(h=Math.abs(s.position.x-t),c=this.enforceMinSize(s.position.x+h,s.position.y-(r=h*this.aspectRatio),e),e.move(c.x,c.y),p.a.instance.returnPoint(c)):(a=this.getSide(p.a.instance.borrow(o+100/this.aspectRatio,n+100/this.aspectRatio*this.aspectRatio),s.position,p.a.instance.borrow(t,i)))<0?(h=Math.abs(s.position.x-t),c=this.enforceMinSize(s.position.x+h,s.position.y+(r=h*this.aspectRatio),e),e.move(c.x,c.y),p.a.instance.returnPoint(c)):a>0&&(r=Math.abs(s.position.y-i),c=this.enforceMinSize(s.position.x+(h=r/this.aspectRatio),s.position.y+r,e),e.move(c.x,c.y),p.a.instance.returnPoint(c));else c=this.enforceMinSize(t,i,e),e.move(c.x,c.y),p.a.instance.returnPoint(c);this.center.recalculatePosition(this.getBounds())},i.prototype.getSide=function(t,e,s){var o=i.sign((e.x-t.x)*(s.y-t.y)-(e.y-t.y)*(s.x-t.x));return p.a.instance.returnPoint(t),p.a.instance.returnPoint(s),o},i.prototype.handleRelease=function(t){if(null!=t){for(var i=0,e=0;e<this.currentDragTouches.length;e++)t.id===this.currentDragTouches[e].id&&(this.currentDragTouches[e].dragHandle.setDrag(!1),i=e);this.currentDragTouches.splice(i,1),this.draw(this.ctx)}},i.prototype.handleMove=function(t){for(var i=!1,e=0;e<this.currentDragTouches.length;e++)if(t.id===this.currentDragTouches[e].id&&null!=this.currentDragTouches[e].dragHandle){var s=this.currentDragTouches[e],o=this.clampPosition(t.x-s.dragHandle.offset.x,t.y-s.dragHandle.offset.y);t.x=o.x,t.y=o.y,p.a.instance.returnPoint(o),s.dragHandle instanceof a?this.dragCorner(t.x,t.y,s.dragHandle):this.dragCenter(t.x,t.y,s.dragHandle),this.currentlyInteracting=!0,i=!0,d.setPressed(this.canvas);break}if(!i){for(var n=0;n<this.markers.length;n++){var r=this.markers[n];if(r.touchInBounds(t.x,t.y)){t.dragHandle=r,this.currentDragTouches.push(t),r.setDrag(!0),t.dragHandle.offset.x=t.x-t.dragHandle.position.x,t.dragHandle.offset.y=t.y-t.dragHandle.position.y,this.dragCorner(t.x-t.dragHandle.offset.x,t.y-t.dragHandle.offset.y,t.dragHandle);break}}null==t.dragHandle&&this.center.touchInBounds(t.x,t.y)&&(t.dragHandle=this.center,this.currentDragTouches.push(t),t.dragHandle.setDrag(!0),t.dragHandle.offset.x=t.x-t.dragHandle.position.x,t.dragHandle.offset.y=t.y-t.dragHandle.position.y,this.dragCenter(t.x-t.dragHandle.offset.x,t.y-t.dragHandle.offset.y,t.dragHandle))}},i.prototype.updateClampBounds=function(){var t=this.srcImage.height/this.srcImage.width,i=this.canvas.width,e=this.canvas.height;this.canvas.height/this.canvas.width>t?(i=this.canvas.width,e=this.canvas.width*t):(e=this.canvas.height,i=this.canvas.height/t),this.minXClamp=this.canvas.width/2-i/2,this.minYClamp=this.canvas.height/2-e/2,this.maxXClamp=this.canvas.width/2+i/2,this.maxYClamp=this.canvas.height/2+e/2},i.prototype.getCropBounds=function(){var t=this.getBounds();return t.top=Math.round((t.top-this.minYClamp)/this.ratioH),t.bottom=Math.round((t.bottom-this.minYClamp)/this.ratioH),t.left=Math.round((t.left-this.minXClamp)/this.ratioW),t.right=Math.round((t.right-this.minXClamp)/this.ratioW),t},i.prototype.clampPosition=function(t,i){return t<this.minXClamp&&(t=this.minXClamp),t>this.maxXClamp&&(t=this.maxXClamp),i<this.minYClamp&&(i=this.minYClamp),i>this.maxYClamp&&(i=this.maxYClamp),p.a.instance.borrow(t,i)},i.prototype.isImageSet=function(){return this.imageSet},i.prototype.setImage=function(t){if(this.srcImage=t,t){this.imageSet=!0,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.buffer.getContext("2d").clearRect(0,0,this.buffer.width,this.buffer.height),this.cropperSettings.fileType||(this.fileType=this.getDataUriMimeType(t.src)),this.cropperSettings.minWithRelativeToResolution&&(this.minWidth=this.canvas.width*this.cropperSettings.minWidth/this.srcImage.width,this.minHeight=this.canvas.height*this.cropperSettings.minHeight/this.srcImage.height),this.updateClampBounds(),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height;var i=this.getCropPositionFromMarkers();this.setCropPosition(i)}else this.imageSet=!1,this.draw(this.ctx)},i.prototype.updateCropPosition=function(t){var i=this.getCropPositionFromBounds(t);this.setCropPosition(i)},i.prototype.setCropPosition=function(t){this.tl.setPosition(t[0].x,t[0].y),this.tr.setPosition(t[1].x,t[1].y),this.bl.setPosition(t[2].x,t[2].y),this.br.setPosition(t[3].x,t[3].y),this.center.setPosition(t[4].x,t[4].y);for(var e=0,s=t;e<s.length;e++)p.a.instance.returnPoint(s[e]);this.vertSquashRatio=i.detectVerticalSquash(this.srcImage),this.draw(this.ctx),this.croppedImage=this.getCroppedImageHelper(!1,this.cropWidth,this.cropHeight)},i.prototype.getCropPositionFromMarkers=function(){var t,i,e,s,o=this.canvas.width,n=this.canvas.height,r=this.srcImage.height/this.srcImage.width,h=this.getBounds(),a=h.height/h.width,c=this.canvas.width/2,u=this.canvas.height/2;if(a>r){var g=Math.min(o*r,n),d=g/a;t=p.a.instance.borrow(c-d/2,u+g/2),i=p.a.instance.borrow(c+d/2,u+g/2),e=p.a.instance.borrow(c-d/2,u-g/2),s=p.a.instance.borrow(c+d/2,u-g/2)}else{var l=Math.min(n/r,o),f=l*a;t=p.a.instance.borrow(c-l/2,u+f/2),i=p.a.instance.borrow(c+l/2,u+f/2),e=p.a.instance.borrow(c-l/2,u-f/2),s=p.a.instance.borrow(c+l/2,u-f/2)}return[t,i,e,s,p.a.instance.borrow(c,u)]},i.prototype.getCropPositionFromBounds=function(t){var i=0,e=0,s=this.srcImage.height/this.srcImage.width;this.canvasHeight/this.canvasWidth>s?i=this.buffer.height/2-this.canvasWidth*s/2:e=this.buffer.width/2-this.canvasHeight/s/2;var o=(this.canvasWidth-2*e)/this.srcImage.width,n=(this.canvasHeight-2*i)/this.srcImage.height,r=t.height*n,h=t.width*o,a=t.left*o+e,c=t.top*n+i;if(this.keepAspect){var u=r/this.aspectRatio,g=h*this.aspectRatio;this.getCropBounds().height===t.height?r=g:this.getCropBounds().width===t.width?h=u:Math.abs(g-r)<Math.abs(u-h)?h=u:r=g}return[p.a.instance.borrow(a,c+r),p.a.instance.borrow(a+h,c+r),p.a.instance.borrow(a,c),p.a.instance.borrow(a+h,c),p.a.instance.borrow(a+h/2,c+r/2)]},i.prototype.getCroppedImageHelper=function(t,i,e){return this.cropperSettings.cropOnResize?this.getCroppedImage(t,i,e):this.croppedImage?this.croppedImage:document.createElement("img")},i.prototype.getCroppedImage=function(t,i,e){var s=this.getBounds();if(this.srcImage){var o=this.srcImage.height/this.srcImage.width,n=this.canvas.height/this.canvas.width,r=this.canvas.width,h=this.canvas.height;n>o?(r=this.canvas.width,h=this.canvas.width*o):n<o?(h=this.canvas.height,r=this.canvas.height/o):(h=this.canvas.height,r=this.canvas.width),this.ratioW=r/this.srcImage.width,this.ratioH=h/this.srcImage.height;var a=(this.buffer.height-h)/2/this.ratioH,c=(this.buffer.width-r)/2/this.ratioW,p=this.cropCanvas.getContext("2d");if(this.cropperSettings.preserveSize||t){var u=Math.round(s.right/this.ratioW-s.left/this.ratioW),g=Math.round(s.bottom/this.ratioH-s.top/this.ratioH);this.cropCanvas.width=u,this.cropCanvas.height=g,this.cropperSettings.croppedWidth=this.cropCanvas.width,this.cropperSettings.croppedHeight=this.cropCanvas.height}else this.cropCanvas.width=this.cropWidth,this.cropCanvas.height=this.cropHeight;return p.clearRect(0,0,this.cropCanvas.width,this.cropCanvas.height),this.drawImageIOSFix(p,this.srcImage,Math.max(Math.round(s.left/this.ratioW-c),0),Math.max(Math.round(s.top/this.ratioH-a),0),Math.max(Math.round(s.width/this.ratioW),1),Math.max(Math.round(s.height/this.ratioH),1),0,0,this.cropCanvas.width,this.cropCanvas.height),this.cropperSettings.resampleFn&&this.cropperSettings.resampleFn(this.cropCanvas),this.croppedImage.width=this.cropCanvas.width,this.croppedImage.height=this.cropCanvas.height,this.croppedImage.src=this.cropCanvas.toDataURL(this.fileType,this.cropperSettings.compressRatio),this.croppedImage}return document.createElement("img")},i.prototype.getBounds=function(){for(var t=Number.MAX_VALUE,i=Number.MAX_VALUE,e=-Number.MAX_VALUE,s=-Number.MAX_VALUE,n=0;n<this.markers.length;n++){var r=this.markers[n];r.position.x<t&&(t=r.position.x),r.position.x>e&&(e=r.position.x),r.position.y<i&&(i=r.position.y),r.position.y>s&&(s=r.position.y)}var h=new o.a;return h.left=t,h.right=e,h.top=i,h.bottom=s,h},i.prototype.setBounds=function(t){for(var i=this.getBounds(),e=0;e<this.markers.length;e++){var s=this.markers[e];s.setPosition(s.position.x===i.left?t.left:t.right,s.position.y===i.top?t.top:t.bottom)}this.center.recalculatePosition(t),this.center.draw(this.ctx),this.draw(this.ctx)},i.prototype.onTouchMove=function(t){if(this.crop.isImageSet()){if(t.preventDefault(),1===t.touches.length)for(var e=0;e<t.touches.length;e++){var s=t.touches[e],o=i.getTouchPos(this.canvas,s),n=new c(o.x,o.y,s.identifier);p.a.instance.returnPoint(o),this.move(n)}else if(2===t.touches.length){var r=(t.touches[0].clientX-t.touches[1].clientX)*(t.touches[0].clientX-t.touches[1].clientX)+(t.touches[0].clientY-t.touches[1].clientY)*(t.touches[0].clientY-t.touches[1].clientY);if(this.previousDistance&&this.previousDistance!==r){var h=this.getBounds();r<this.previousDistance&&(h.top+=1,h.left+=1,h.right-=1,h.bottom-=1),r>this.previousDistance&&(h.top!==this.minYClamp&&h.bottom!==this.maxYClamp&&h.left!==this.minXClamp&&h.right!==this.maxXClamp?(h.top-=1,h.left-=1,h.right+=1,h.bottom+=1):h.top!==this.minYClamp&&h.bottom!==this.maxYClamp&&h.left===this.minXClamp&&h.right!==this.maxXClamp?(h.top-=1,h.right+=2,h.bottom+=1):h.top!==this.minYClamp&&h.bottom!==this.maxYClamp&&h.left!==this.minXClamp&&h.right===this.maxXClamp?(h.top-=1,h.left-=2,h.bottom+=1):h.top===this.minYClamp&&h.bottom!==this.maxYClamp&&h.left!==this.minXClamp&&h.right!==this.maxXClamp?(h.left-=1,h.right+=1,h.bottom+=2):h.top!==this.minYClamp&&h.bottom===this.maxYClamp&&h.left!==this.minXClamp&&h.right!==this.maxXClamp?(h.top-=2,h.left-=1,h.right+=1):h.top===this.minYClamp&&h.bottom!==this.maxYClamp&&h.left===this.minXClamp&&h.right!==this.maxXClamp?(h.right+=2,h.bottom+=2):h.top===this.minYClamp&&h.bottom!==this.maxYClamp&&h.left!==this.minXClamp&&h.right===this.maxXClamp?(h.left-=2,h.bottom+=2):h.top!==this.minYClamp&&h.bottom===this.maxYClamp&&h.left===this.minXClamp&&h.right!==this.maxXClamp?(h.top-=2,h.right+=2):h.top!==this.minYClamp&&h.bottom===this.maxYClamp&&h.left!==this.minXClamp&&h.right===this.maxXClamp&&(h.top-=2,h.left-=2)),h.top<this.minYClamp&&(h.top=this.minYClamp),h.bottom>this.maxYClamp&&(h.bottom=this.maxYClamp),h.left<this.minXClamp&&(h.left=this.minXClamp),h.right>this.maxXClamp&&(h.right=this.maxXClamp),this.setBounds(h)}this.previousDistance=r}this.draw(this.ctx)}},i.prototype.onMouseMove=function(t){if(this.crop.isImageSet()&&this.isMouseDown){var e=i.getMousePos(this.canvas,t);this.move(new c(e.x,e.y,0));var s=this.getDragTouchForID(0);s?(s.x=e.x,s.y=e.y):s=new c(e.x,e.y,0),p.a.instance.returnPoint(e),this.drawCursors(s),this.draw(this.ctx)}},i.prototype.move=function(t){this.isMouseDown&&this.handleMove(t)},i.prototype.getDragTouchForID=function(t){for(var i=0;i<this.currentDragTouches.length;i++)if(t===this.currentDragTouches[i].id)return this.currentDragTouches[i]},i.prototype.drawCursors=function(t){var i=!1;null!=t&&(t.dragHandle===this.center&&(d.setStyle(this.canvas,"move"),i=!0),null!==t.dragHandle&&t.dragHandle instanceof a&&(this.drawCornerCursor(t.dragHandle,t.dragHandle.position.x,t.dragHandle.position.y),i=!0));var e=!1;if(!i){for(var s=0;s<this.markers.length;s++)e=e||this.drawCornerCursor(this.markers[s],t.x,t.y);e||d.setStyle(this.canvas,"initial")}e||i||!this.center.touchInBounds(t.x,t.y)?this.center.setOver(!1):(this.center.setOver(!0),d.setOver(this.canvas),d.setStyle(this.canvas,"move"))},i.prototype.drawCornerCursor=function(t,i,e){return t.touchInBounds(i,e)?(t.setOver(!0),t.getHorizontalNeighbour().position.x>t.position.x?t.getVerticalNeighbour().position.y>t.position.y?(d.setOver(this.canvas),d.setStyle(this.canvas,"nwse-resize")):(d.setOver(this.canvas),d.setStyle(this.canvas,"nesw-resize")):t.getVerticalNeighbour().position.y>t.position.y?(d.setOver(this.canvas),d.setStyle(this.canvas,"nesw-resize")):(d.setOver(this.canvas),d.setStyle(this.canvas,"nwse-resize")),!0):(t.setOver(!1),!1)},i.prototype.onTouchStart=function(t){this.crop.isImageSet()&&(this.isMouseDown=!0)},i.prototype.onTouchEnd=function(t){if(this.crop.isImageSet()){for(var i=0;i<t.changedTouches.length;i++){var e=this.getDragTouchForID(t.changedTouches[i].identifier);e&&void 0!==e&&((e.dragHandle instanceof a||e.dragHandle instanceof u)&&e.dragHandle.setOver(!1),this.handleRelease(e))}0===this.currentDragTouches.length&&(this.isMouseDown=!1,this.currentlyInteracting=!1)}},i.prototype.drawImageIOSFix=function(t,i,e,s,o,n,r,h,a,c){t.drawImage(i,e,s,o,n,r,h,a,c)},i.prototype.onMouseDown=function(t){this.crop.isImageSet()&&(this.isMouseDown=!0)},i.prototype.onMouseUp=function(t){this.crop.isImageSet()&&(d.setReleased(this.canvas),this.isMouseDown=!1,this.handleRelease(new c(0,0,0)))},i}(g)},suHk:function(t,i,e){"use strict";e.d(i,"a",function(){return s});var s=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}return Object.defineProperty(t.prototype,"next",{get:function(){return this._next},set:function(t){this._next=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prev",{get:function(){return this._prev},set:function(t){this._prev=t},enumerable:!0,configurable:!0}),t}()}}]);